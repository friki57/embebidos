<!DOCTYPE html>
<html lang="es" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>PachaWeb Estación Metereológica</title>
    <link rel="stylesheet" href="estilos.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.4.5/socket.io.js"></script>
  </head>
  <body>
    <div class="cv1">
      <div class="cv">
        <h1 style="font-size:40px;margin-top:80px;"> Welcome to PachaWeb</h1>
      </div>
      <div class="espacio" style="">
        <table id="myTable" class="table table-borderless table-striped table-earning">
          <thead>
            <tr>
              <th>date</th>
              <th>file name</th>
            </tr>
          </thead>
          <tbody id="testBody"></tbody>
        </table>
        <script>

        </script>
      </div>
    </div>
    <script type="text/javascript">
  var pedirDatos = function()
  {
    fetch('/leer')
        .then(response => response.text())
        .then(data => {
          data = JSON.parse(data)
          console.log(data);
          function loadTableData(items) {
            const table = document.getElementById("testBody");
            items.forEach( item => {
              let row = table.insertRow();
              let date = row.insertCell(0);
              date.innerHTML = item.fecha;
              let temp = row.insertCell(1);
              temp.innerHTML = item.temp;
              let hume = row.insertCell(1);
              hume.innerHTML = item.hume;
              let gas = row.insertCell(1);
              gas.innerHTML = item.gas;
              let lluvia = row.insertCell(1);
              lluvia.innerHTML = item.lluvia;
              let suelo = row.insertCell(1);
              suelo.innerHTML = item.suelo;
            });
          }
          loadTableData(data);
        });
  }
  pedirDatos();
  setInterval(pedirDatos,10000)

    </script>
  </body>
</html>
